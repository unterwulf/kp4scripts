#!/bin/sh
#
# Mount FUSE filesystems by mount point using ~/.fstab file
#

FSTAB=~/.fstab

if [ $# -ne 1 ] || [ "$1" = "-h" ] || [ "$1" = "--help" ]; then
   echo "usage: $(basename $0) MOUNTPOINT" >&2
   exit 1
fi

mountpoint=$(readlink -f -- "$1")
fs=$(awk -v mp="$mountpoint" '$2 == mp { print $1; exit }' $FSTAB)

if [ -n "$fs" ]; then
   IFS='#'
   set $fs
   exec "$1" "$2" $mountpoint
else
   echo "$(basename $0): can't find $1 in $FSTAB" >&2
fi

exit 1
